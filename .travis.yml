language: objective-c
os:
  - osx
before_install:
  - curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.30.1/install.sh | bash
  - source ~/.bashrc
script:
  - nvm install stable
  - nvm use stable

  - npm install
  - npm run lint
  - npm test

  - npm run dist
  - npm run pack:osx
  - npm run build:osx

env:
  global:
    secure: G+XZC/waQnr30Y0lmrSOB3eFhljXfyH/o8kD4zedC9LT+eAbYqZdB0yatIONDPFq9v3jIiWbZBrn0XKJCVgzWpftscQOmGqQ8UAPUcdyxPPq2vjaXGseM/cmzBNb94sA0KQvDgLNygf+QI64CGW8Y2OF8p6tUlsrHqzQR8tBjIxUDUoHmURc+oCIkLN/Y1VDdM1EoR/qQpYYISWYvOMn4wXQ6srIChsSKHIQlX8z+u8Tas6slIqtLaxjyyCLAHsMk+ps2CS7do1JSIN7bjvp7vJN03r98J5lMjiDwCAmJD8JqW3aF+iQJm+LO3RFGEi5/JeMUSjrJ0Y4fFZ9jnPa4Zwydt448I4v7DPpASO2Koxi4YREBO5bCZRMfogZ/iyQYQZ1MuIgiFsjije6TOTJOUFVtQJznHkxdx6U7XSr/8POJsCVq5uBCCcBzbdYk2dWmOyQdcNEeYJHB/3H0FTRN+1bd3lGNYPjHuqjrC1RmMyqBeZbOIvhH6Z5g1GEqvIhUm2FypcffdqcqEcFnd58EkkxvG7qCOybNvtK6WFhYdiCuo2nl/+YMXjOhQsL0WfdQLjX/KP1DfrUyN0Exwnv2B/6+fbxlBJiZ0cP4itWG2O2KE172Ee7Pk0jWqOgSgYYeE7sm3Sg7919NNnkgvZmQntufSygv8kLRVyUPc340/A=

deploy:
  provider: releases
  api_key:
    secure: ${GITHUB_TOKEN}
  file: ./release/osx/ESRScan.dmg
  skip_cleanup: true
  on:
    tags: true
after_deploy: ./scripts/travis-after-deploy.sh
